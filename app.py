import streamlit as st
import google.generativeai as genai
import tempfile
import os

# --- 0. æ ¸å¿ƒæç¤ºè¯ (Prompt) - ç§»åˆ°æœ€å‰é¢é˜²æ­¢æŠ¥é”™ ---
DIRECTOR_PROMPT = """
ä½ æ˜¯ä¸€ä½é¡¶çº§æ¼”è®²æ’°ç¨¿äººã€‚è¯·ä»”ç»†å¬è¿™æ®µå½•éŸ³ï¼Œå®Œæˆä»¥ä¸‹ä¸¤ä¸ªä»»åŠ¡ï¼š

**ä»»åŠ¡ä¸€ï¼šé£æ ¼å­¦ä¹  (Style Analysis)**
1. æ•æ‰è¯´è¯äººçš„ã€æƒ…ç»ªçŠ¶æ€ã€‘ï¼ˆå¦‚ï¼šå…´å¥‹ã€å†·é™ã€åæ§½ã€äº²åˆ‡ï¼‰ã€‚
2. æ•æ‰è¯´è¯äººçš„ã€è¯­è¨€é£æ ¼ã€‘ï¼ˆå¦‚ï¼šå–œæ¬¢ç”¨åé—®ã€å–œæ¬¢ç”¨çŸ­å¥ã€å¹½é»˜æ„Ÿã€è¿˜æ˜¯ä¸“ä¸šä¸¥è°¨ï¼‰ã€‚

**ä»»åŠ¡äºŒï¼šæ’°å†™å£æ’­é€å­—ç¨¿ (Script Writing)**
åŸºäºå½•éŸ³çš„æ ¸å¿ƒå†…å®¹ï¼Œ**ä¿æŒä¸Šè¿°åˆ†æå‡ºçš„ç”¨æˆ·é£æ ¼**ï¼Œå°†å…¶æ”¹å†™ä¸ºä¸€ç¯‡**å¯ä»¥ç›´æ¥ç…§ç€å¿µçš„é€å­—ç¨¿**ã€‚

**ç¨¿ä»¶ç»“æ„å¼ºåˆ¶è¦æ±‚ï¼š**
1. **é»„é‡‘ä¸‰ç§’ (Hook):** å¼€å¤´å¿…é¡»æŠ“äººï¼Œåˆ¶é€ æ‚¬å¿µæˆ–å…±é¸£ã€‚
2. **å†…å®¹åŒºå— (Body):** å°†å†…å®¹é€»è¾‘åˆ†æ®µï¼Œæ¯æ®µåªè®²ä¸€ä¸ªç‚¹ã€‚
3. **ç»“å°¾å‡å (CTA):** é‡‘å¥æ”¶å°¾ï¼Œå¼•å¯¼è¡ŒåŠ¨ã€‚

**Output Format (Markdown æ’ç‰ˆè§„åˆ™ - é€‚é… iPad æè¯å™¨):**

## ğŸ“ é£æ ¼åˆ†ææŠ¥å‘Š
* **æ£€æµ‹åˆ°çš„æƒ…ç»ª:** [ä¾‹å¦‚ï¼šå……æ»¡æ¿€æƒ…çš„]
* **å»ºè®®æ¼”ç»æ–¹å¼:** [ä¾‹å¦‚ï¼šè¯­é€ŸåŠ å¿«ï¼Œé…åˆæ‰‹åŠ¿]

---

## ğŸ¥ æ‹æ‘„é€å­—ç¨¿ (Teleprompter Script)

**ã€Part 1ï¼šé»„é‡‘ä¸‰ç§’ã€‘**
> (åŠ¨ä½œæŒ‡å¯¼ï¼Œä¾‹å¦‚ï¼šçœ¼ç¥çŠ€åˆ©ï¼Œèº«ä½“å‰å€¾)
# è¿™é‡Œå†™ç¬¬ä¸€å¥å°è¯ï¼Œè¦æ˜¯å®Œæ•´çš„å¥å­ã€‚
# å“ªæ€•æ˜¯çŸ­å¥ä¹Ÿè¦åˆ†è¡Œå†™ã€‚

**ã€Part 2ï¼šæ ¸å¿ƒå†…å®¹ã€‘**
> (åŠ¨ä½œæŒ‡å¯¼ï¼Œä¾‹å¦‚ï¼šæ”¾æ¾è¯­è°ƒï¼Œåƒæ˜¯åœ¨å’Œæœ‹å‹èŠå¤©)
# è¿™é‡Œå†™æ­£æ–‡å†…å®¹çš„é€å­—ç¨¿ã€‚
# ä¿æŒç”¨æˆ·çš„å£è¯­ä¹ æƒ¯ï¼Œä¸è¦å¤ªä¹¦é¢åŒ–ã€‚
# æ¯ä¸€å¥å£æ’­è¯éƒ½è¦ç”¨ # å¼€å¤´ï¼Œè¿™æ ·å­—æ‰å¤Ÿå¤§ã€‚

**ã€Part 3ï¼šç»“å°¾ã€‘**
> (åŠ¨ä½œæŒ‡å¯¼ï¼Œä¾‹å¦‚ï¼šå¾®ç¬‘ï¼Œç¬ƒå®š)
# è¿™é‡Œå†™ç»“å°¾é‡‘å¥ã€‚
# è®°å¾—å¼•å¯¼ç‚¹èµå…³æ³¨ã€‚

---
*(æ³¨æ„ï¼šç”Ÿæˆçš„ç¨¿ä»¶å¿…é¡»æ˜¯ã€é€å­—ç¨¿ã€‘ï¼Œç”¨æˆ·ä¸éœ€è¦è‡ªå·±ç»„ç»‡è¯­è¨€ï¼Œç›´æ¥å¿µå³å¯ã€‚)*
"""

# --- 1. é¡µé¢åŸºç¡€é…ç½® ---
st.set_page_config(page_title="AI å½±å­å†™æ‰‹", layout="wide")

# --- 2. æ³¨å…¥ CSS æ ·å¼ ---
st.markdown("""
<style>
    .stApp { background-color: #F2F0E9; }
    * { font-family: 'Times New Roman', 'Songti SC', serif !important; }
    
    /* æ ‡é¢˜æ ·å¼ */
    h2 {
        color: #1a1a1a !important;
        font-size: 32px !important;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
        margin-top: 40px !important;
    }

    /* æè¯å™¨å¤§å­—æŠ¥æ ·å¼ -
